{% extends "base.html" %}
{% block title %}Dashboard — Mini Banca{% endblock %}
{% block content %}
  <div class="row">
    <div class="card">
      <h3>Benvenuto, {{ user.username }}</h3>
      <p>Saldo attuale:</p>
      <h2>€ {{ '%.2f' % (acct.balance / 100) }}</h2>
      <p><a href="{{ url_for('auth.logout') }}"><button>Logout</button></a></p>
    </div>
    <div class="card">
      <h3>Deposito</h3>
      <form method="post" action="{{ url_for('bank.deposit') }}">
        <input type="text" name="amount" placeholder="Importo es. 50.00" required>
        <button type="submit">Deposita</button>
      </form>
    </div>
    <div class="card">
      <h3>Prelievo</h3>
      <form method="post" action="{{ url_for('bank.withdraw') }}">
        <input type="text" name="amount" placeholder="Importo es. 20.00" required>
        <button type="submit">Preleva</button>
      </form>
    </div>
    <div class="card">
      <h3>Bonifico</h3>
      <form method="post" action="{{ url_for('bank.transfer') }}">
        <input type="text" name="to" placeholder="Destinatario (username)" required>
        <input type="text" name="amount" placeholder="Importo es. 10.00" required>
        <button type="submit">Invia</button>
      </form>
    </div>
  </div>

  <h3>Ultimi movimenti</h3>
  <table>
    <thead><tr><th>Quando</th><th>Tipo</th><th class="right">Importo</th><th>Note</th></tr></thead>
    <tbody>
      {% for t in txs %}
        <tr>
          <td>{{ t.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
          <td>{{ t.kind }}</td>
          <td class="right">€ {{ '%.2f' % (t.amount / 100) }}</td>
          <td>{{ t.note or '' }}</td>
        </tr>
      {% else %}
        <tr><td colspan="4" class="muted">Nessuna transazione</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
